<!-- Downloads and Uploads -->
<section id="widget-grid" class="">
    <div class="row">
        <article class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
            <div class="jarviswidget" id="wid-id-1" data-widget-refresh="2000"
                 data-widget-load="components/widgets/downloads-series.html"  data-widget-colorbutton="false">
                <header>
                    <h2>Total Daily Downloads Distribution</h2>
                </header>
                <div>
                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">
                        <!-- This area used as dropdown edit box -->
                        <input class="form-control" type="text">
                        <span class="note"><i class="fa fa-check text-success"></i> Change title to update and save instantly!</span>
                    </div>
                    <!-- end widget edit box -->

                    <!-- widget content -->
                    <div class="widget-body">
                        <div>
                            <div class="sk-spinner sk-spinner-three-bounce">
                                <div class="sk-bounce1"></div>
                                <div class="sk-bounce2"></div>
                                <div class="sk-bounce3"></div>
                            </div>
                        </div>
                    </div>
                    <!-- end widget content -->
                </div>
            </div>
        </article>
        <article class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
            <div class="jarviswidget" id="wid-id-2" data-widget-refresh="2000"  data-widget-colorbutton="false"
                 data-widget-load="components/widgets/dailyusers-series.html">
                <header>
                    <h2>Total Daily Users Distribution</h2>
                </header>
                <div>
                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">
                        <!-- This area used as dropdown edit box -->
                        <input class="form-control" type="text">
                        <span class="note"><i class="fa fa-check text-success"></i> Change title to update and save instantly!</span>
                    </div>
                    <!-- end widget edit box -->

                    <!-- widget content -->
                    <div class="widget-body">
                        <div>
                            <div class="sk-spinner sk-spinner-three-bounce">
                                <div class="sk-bounce1"></div>
                                <div class="sk-bounce2"></div>
                                <div class="sk-bounce3"></div>
                            </div>
                        </div>
                    </div>
                    <!-- end widget content -->
                </div>
            </div>
        </article>
    </div>
    <div class="row">
        <article class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
            <div class="jarviswidget" id="wid-id-3" data-widget-refresh="2000"  data-widget-colorbutton="false"
                 data-widget-load="components/widgets/dailyuserdownloads-series.html">
                <header>
                    <h2><strong>Average Daily Users Downloads Distribution</strong></h2>
                </header>
                <div>
                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">
                        <!-- This area used as dropdown edit box -->
                        <input class="form-control" type="text">
                        <span class="note"><i class="fa fa-check text-success"></i> Change title to update and save instantly!</span>
                    </div>
                    <!-- end widget edit box -->

                    <!-- widget content -->
                    <div class="widget-body">
                        <div>
                            <div class="sk-spinner sk-spinner-three-bounce">
                                <div class="sk-bounce1"></div>
                                <div class="sk-bounce2"></div>
                                <div class="sk-bounce3"></div>
                            </div>
                        </div>
                    </div>
                    <!-- end widget content -->
                </div>
            </div>
        </article>
        <article class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
            <div class="jarviswidget" id="wid-id-4" data-widget-refresh="2000"  data-widget-colorbutton="false"
                 data-widget-load="components/widgets/avgusersession-series.html">
                <header>
                    <h2><strong>Average Daily Users Session Distribution</strong></h2>
                </header>
                <div>
                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">
                        <!-- This area used as dropdown edit box -->
                        <input class="form-control" type="text">
                        <span class="note"><i class="fa fa-check text-success"></i> Change title to update and save instantly!</span>
                    </div>
                    <!-- end widget edit box -->

                    <!-- widget content -->
                    <div class="widget-body">
                        <div>
                            <div class="sk-spinner sk-spinner-three-bounce">
                                <div class="sk-bounce1"></div>
                                <div class="sk-bounce2"></div>
                                <div class="sk-bounce3"></div>
                            </div>
                        </div>
                    </div>
                    <!-- end widget content -->
                </div>
            </div>
        </article>
    </div>
</section>

<div class="row">
    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-downloads">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-uploads">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-totalusers">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-avgdatausageperuser">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-avgsessiontime">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-totalsessioncount">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row" style="margin-top: 40px;">

    <div class="col-lg-4">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins" id="metric-usercountover1MB">
                    <div class="ibox-title">
                        <span class="label label-{{{style}}} pull-right">Today</span>
                        <h5></h5>
                    </div>
                    <div class="ibox-content">
                        <div class="sk-spinner sk-spinner-three-bounce">
                            <div class="sk-bounce1"></div>
                            <div class="sk-bounce2"></div>
                            <div class="sk-bounce3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins" id="metric-returningusers">
                    <div class="ibox-title">
                        <span class="label label-{{{style}}} pull-right">Today</span>
                        <h5></h5>
                    </div>
                    <div class="ibox-content">
                        <div class="sk-spinner sk-spinner-three-bounce">
                            <div class="sk-bounce1"></div>
                            <div class="sk-bounce2"></div>
                            <div class="sk-bounce3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="col-lg-4">
        <div class="ibox float-e-margins" id="metric-usersbyos">
            <div class="ibox-title">
                <span class="label label-{{{style}}} pull-right">Today</span>
                <h5></h5>
            </div>
            <div class="ibox-content">
                <div class="sk-spinner sk-spinner-three-bounce">
                    <div class="sk-bounce1"></div>
                    <div class="sk-bounce2"></div>
                    <div class="sk-bounce3"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="ibox float-e-margins">
            <div class="ibox float-e-margins" id="metric-usersbydevicetype">
                <div class="ibox-title">
                    <span class="label label-{{{style}}} pull-right">Today</span>
                    <h5></h5>
                </div>
                <div class="ibox-content">
                    <div class="sk-spinner sk-spinner-three-bounce">
                        <div class="sk-bounce1"></div>
                        <div class="sk-bounce2"></div>
                        <div class="sk-bounce3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(
            function () {
                pageSetUp();
                var payload = {
                    from: from_,
                    to: to_,
                    groupnames: window.datagroups,
                    tenantid: parseInt(Cookies.get("tenantid"))
                };
                window.payload = payload
                var totaldownloads = 0, totaluploads = 0, uniqueuserscount = 0

                var renderTotalDownloads = $.post('/wifi/usage/downloads', JSON.stringify(payload), function (data, status) {
                    totaldownloads = data
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Total Downloads',
                            value: numeral(data).format('0.00b'),
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-downloads').html(rendered)
                    })
                });

                var renderTotalUploads = $.post('/wifi/usage/uploads', JSON.stringify(payload), function (data, status) {
                    totaluploads = data
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Total Uploads',
                            value: numeral(data).format('0.00b'),
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-uploads').html(rendered)
                    })
                });

                var renderTotalUserCount = $.post('/wifi/users/count', JSON.stringify(payload), function (data, status) {
                    uniqueuserscount = (data === 0 ? 1 : data);
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Total Users',
                            value: data,
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-totalusers').html(rendered)
                    })
                });

                $.post('/wifi/sessions/avg', JSON.stringify(payload), function (data, status) {
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Avg User session time',
                            value: numeral(data).format('00:00:00'),
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-avgsessiontime').html(rendered)
                    })
                });

                $.post('/wifi/sessions/count', JSON.stringify(payload), function (data, status) {
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Total Sessions',
                            value: data,
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-totalsessioncount').html(rendered)
                    })
                });

                $.post('/wifi/users/countbydownlods/1000000', JSON.stringify(payload), function (data, status) {
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Unique Users (>1MB)',
                            value: data,
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-usercountover1MB').html(rendered)
                    })
                });

                $.when(renderTotalDownloads, renderTotalUploads, renderTotalUserCount).done(function () {
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Avg Data Usage per User',
                            value: numeral((totaldownloads + totaluploads) / uniqueuserscount).format('0.00b'),
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-avgdatausageperuser').html(rendered)
                    })
                });

                $.post('/wifi/users/returncount', JSON.stringify(payload), function (data, status) {
                    $.get('components/metric-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            caption: 'Returning Users',
                            value: data,
                            titlecolor: '#12A6A8'
                        });
                        $('#metric-returningusers').html(rendered)
                    })
                });

                $.post('/wifi/devices/osstats', JSON.stringify(payload), function (data, status) {
                    $.get('components/metric-piechart-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            id: 0,
                            caption: 'Browser Stats',
                            style: 'success',
                            data: JSON.stringify(getPieChartData(data)),
                            titlecolor: '#2F4050'
                        });
                        $('#metric-usersbyos').html(rendered)
                    })
                });

                $.post('/wifi/devices/devicestats', JSON.stringify(payload), function (data, status) {
                    $.get('components/metric-piechart-base.html', function (template) {
                        var rendered = Mustache.render(template, {
                            id: 1,
                            caption: 'Device Stats',
                            style: 'success',
                            data: JSON.stringify(getPieChartData(data)),
                            titlecolor: '#2F4050'
                        })
                        $('#metric-usersbydevicetype').html(rendered)
                    })
                });

            }
    );

</script>